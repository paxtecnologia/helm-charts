# O helm do fluent-bit n√£o aceita uso de alias, tem que manter o nome original
fluent-bit:
  replicaCount: 2
  config:
    outputs: |
      [OUTPUT]
          Name es
          Match kube.*
          Host loki-master
          Logstash_Format On
          Retry_Limit False
      [OUTPUT]
          Name es
          Match host.*
          Host loki-master
          Logstash_Format On
          Logstash_Prefix node
          Retry_Limit False

  loki:
    loki:
      schemaConfig:
        configs:
          - from: "2024-04-01"
            store: tsdb
            object_store: s3
            schema: v13
            index:
              prefix: loki_index_
              period: 24h
      ingester:
        chunk_encoding: snappy
      querier:
        # Default is 4, if you have enough memory and CPU you can increase, reduce if OOMing
        max_concurrent: 4
      pattern_ingester:
        enabled: true
      limits_config:
        allow_structured_metadata: true
        volume_enabled: true

      deploymentMode: SimpleScalable

      backend:
        replicas: 2
      read:
        replicas: 2
      write:
        replicas: 3 # To ensure data durability with replication

      # Enable minio for storage
      minio:
        enabled: false

      gateway:
        service:
          type: LoadBalancer
